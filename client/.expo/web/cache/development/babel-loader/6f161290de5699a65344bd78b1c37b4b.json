{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { TextInput, Text } from \"../../src/components/Themed\";\nimport { UserContext } from \"../../src/contexts/user\";\nimport { ChatsContext } from \"../../src/contexts/chats\";\nimport { CreateSocketConnection } from \"../../src/utils/socket\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Chat(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      socket = _useState2[0],\n      setSocket = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      messages = _useState4[0],\n      setMessages = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      text = _useState6[0],\n      setText = _useState6[1];\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.user;\n\n  var _useContext2 = useContext(ChatsContext),\n      chats = _useContext2.chats;\n\n  useEffect(function () {\n    var chatId = route.params.id;\n\n    if (chatId) {\n      var socketConnection = CreateSocketConnection();\n      socketConnection.emit(\"joinRoom\", chatId);\n      setSocket(socketConnection);\n      socketConnection.on(\"receiveMessage\", function (msg, client) {\n        console.log(msg);\n      });\n    }\n  }, [user, chats]);\n  useEffect(function () {}, [messages]);\n\n  function sendMessage() {\n    var timeNow = new Date().getTime();\n    var message = {\n      author: user,\n      content: text,\n      createdAt: timeNow,\n      id: \"\" + timeNow.toString().slice(1) + Math.floor(Math.random() * (9 - 0 + 1) + 0)\n    };\n    socket.emit(\"sendMessage\", {\n      room: chat.id,\n      message: message\n    });\n    setText(\"\");\n  }\n\n  return _jsxs(View, {\n    children: [_jsx(View, {\n      children: messages.map(function (msg, index) {\n        return _jsx(Text, {\n          children: msg\n        }, index);\n      })\n    }), _jsxs(View, {\n      children: [_jsx(TextInput, {\n        placeholder: \"Mensagem...\",\n        value: text,\n        onChangeText: function onChangeText(value) {\n          return setText(value);\n        }\n      }), _jsx(TouchableOpacity, {\n        onPress: function onPress() {\n          return sendMessage();\n        },\n        children: _jsx(Text, {\n          children: \"Send\"\n        })\n      })]\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: StatusBar.currentHeight\n  },\n  topContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 5,\n    justifyContent: \"space-between\"\n  },\n  topContainerLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  topContainerRight: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\"\n  },\n  messageContainer: {\n    flex: 1,\n    marginHorizontal: 10,\n    flexDirection: \"column-reverse\",\n    marginBottom: 55\n  },\n  bottomContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    position: \"absolute\",\n    backgroundColor: \"rgb(18, 18, 18)\",\n    justifyContent: \"space-between\",\n    borderRadius: 50,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    padding: 5,\n    margin: 5\n  },\n  messageCard: {\n    borderWidth: 1,\n    borderColor: \"#222\"\n  },\n  myMessage: {\n    justifyContent: \"flex-end\",\n    flexDirection: \"revert\"\n  },\n  otherMessage: {\n    width: \"fit-content\",\n    maxWidth: \"85%\"\n  },\n  userIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 100,\n    marginHorizontal: 5\n  },\n  userProfile: {\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  backButton: {\n    padding: 5,\n    borderRadius: 100\n  },\n  blueButton: {\n    backgroundColor: \"#2f95dc\",\n    padding: 8,\n    borderRadius: 100\n  },\n  othersMedias: {\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  inputMessage: {\n    paddingVertical: 8,\n    width: \"100%\",\n    marginLeft: 10\n  },\n  message: {\n    padding: 7,\n    borderRadius: 20,\n    flexDirection: \"row\",\n    marginBottom: 10,\n    alignItems: \"flex-end\",\n    flexWrap: \"wrap\"\n  },\n  messageCreatedAt: {\n    fontSize: 10,\n    marginLeft: 5\n  },\n  buttonContentLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\"\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","useContext","TextInput","Text","UserContext","ChatsContext","CreateSocketConnection","Chat","navigation","route","socket","setSocket","messages","setMessages","text","setText","user","chats","chatId","params","id","socketConnection","emit","on","msg","client","console","log","sendMessage","timeNow","Date","getTime","message","author","content","createdAt","toString","slice","Math","floor","random","room","chat","map","index","value","styles","StyleSheet","create","container","flex","marginTop","StatusBar","currentHeight","topContainer","flexDirection","alignItems","padding","justifyContent","topContainerLeft","topContainerRight","messageContainer","marginHorizontal","marginBottom","bottomContainer","position","backgroundColor","borderRadius","bottom","left","right","margin","messageCard","borderWidth","borderColor","myMessage","otherMessage","width","maxWidth","userIcon","height","userProfile","backButton","blueButton","othersMedias","inputMessage","paddingVertical","marginLeft","flexWrap","messageCreatedAt","fontSize","buttonContentLeft"],"sources":["/home/samuel/Documentos/projetos/mobile/halk/client/screens/chat/chat.tsx"],"sourcesContent":["import React, { useEffect, useState, useContext, useRef } from \"react\";\nimport {\n  Button,\n  StatusBar,\n  StyleSheet,\n  View,\n  Image,\n  Pressable,\n  ScrollView,\n  TouchableOpacity,\n} from \"react-native\";\nimport {\n  AntDesign,\n  Ionicons,\n  Feather,\n  FontAwesome,\n  MaterialIcons,\n  Fontisto,\n} from \"@expo/vector-icons\";\nimport { RootStackScreenProps } from \"../../types\";\nimport { TextInput, Text } from \"../../src/components/Themed\";\nimport { UserContext } from \"../../src/contexts/user\";\nimport { ChatsContext } from \"../../src/contexts/chats\";\nimport Socket, { CreateSocketConnection } from \"../../src/utils/socket\";\nimport { getColors } from \"../../constants/Colors\";\n\nexport default function Chat({\n  navigation,\n  route,\n}: RootStackScreenProps<\"Chat\">) {\n  const [socket, setSocket] = useState();\n  const [messages, setMessages] = useState([]);\n  const [text, setText] = useState(\"\");\n\n  const { user } = useContext(UserContext);\n  const { chats } = useContext(ChatsContext);\n\n  useEffect(() => {\n    const chatId = route.params.id;\n\n    if (chatId) {\n      const socketConnection = CreateSocketConnection();\n      socketConnection.emit(\"joinRoom\", chatId);\n      setSocket(socketConnection);\n\n      socketConnection.on(\"receiveMessage\", (msg, client) => {\n        console.log(msg);\n        // setMessages(oldMessages => [...oldMessages, msg]);\n      });\n    }\n  }, [user, chats]);\n\n  useEffect(() => {}, [messages]);\n\n  function sendMessage() {\n    const timeNow = new Date().getTime();\n    const message = {\n      author: user,\n      content: text,\n      createdAt: timeNow,\n      id: `${timeNow.toString().slice(1)}${Math.floor(Math.random() * (9 - 0 + 1) + 0)}`\n    };\n\n    socket.emit(\"sendMessage\", { room: chat.id, message });\n    setText(\"\");\n  }\n\n  return (\n    <View>\n      <View>\n        {messages.map((msg, index) => (\n          <Text key={index}>{msg}</Text>\n        ))}\n      </View>\n      <View>\n        <TextInput\n          placeholder=\"Mensagem...\"\n          value={text}\n          onChangeText={(value) => setText(value)}\n        />\n        <TouchableOpacity onPress={() => sendMessage()}>\n          <Text>Send</Text>\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: StatusBar.currentHeight,\n  },\n  topContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 5,\n    justifyContent: \"space-between\",\n  },\n  topContainerLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  topContainerRight: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n  },\n  messageContainer: {\n    flex: 1,\n    marginHorizontal: 10,\n    flexDirection: \"column-reverse\",\n    marginBottom: 55,\n  },\n  bottomContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    position: \"absolute\",\n    backgroundColor: \"rgb(18, 18, 18)\",\n    justifyContent: \"space-between\",\n    borderRadius: 50,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    padding: 5,\n    margin: 5,\n  },\n  messageCard: {\n    borderWidth: 1,\n    borderColor: \"#222\",\n  },\n  myMessage: {\n    justifyContent: \"flex-end\",\n    flexDirection: \"revert\",\n  },\n  otherMessage: {\n    width: \"fit-content\",\n    maxWidth: \"85%\",\n  },\n  userIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 100,\n    marginHorizontal: 5,\n  },\n  userProfile: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  backButton: {\n    padding: 5,\n    borderRadius: 100,\n  },\n  blueButton: {\n    backgroundColor: \"#2f95dc\",\n    padding: 8,\n    borderRadius: 100,\n  },\n  othersMedias: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  inputMessage: {\n    paddingVertical: 8,\n    width: \"100%\",\n    marginLeft: 10,\n  },\n  message: {\n    padding: 7,\n    borderRadius: 20,\n    flexDirection: \"row\",\n    marginBottom: 10,\n    alignItems: \"flex-end\",\n    flexWrap: \"wrap\",\n  },\n  messageCreatedAt: {\n    fontSize: 10,\n    marginLeft: 5,\n  },\n  buttonContentLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}