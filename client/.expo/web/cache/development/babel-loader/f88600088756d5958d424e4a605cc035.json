{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nvar api_link = \"http://localhost:3000\";\nvar POST_PARAMS = {\n  method: \"POST\",\n  headers: {\n    \"Content-type\": \"application/json\"\n  }\n};\nexport var uploadImage = function () {\n  var _ref = _asyncToGenerator(function* (image) {\n    var clientId = process.env.IMGUR_ID;\n    var clientSecret = process.env.IMGUR_SECRET;\n\n    function blobToBase64(blob) {\n      return new Promise(function (resolve, _) {\n        var reader = new FileReader();\n\n        reader.onloadend = function () {\n          return resolve(reader.result);\n        };\n\n        reader.readAsDataURL(blob);\n      });\n    }\n\n    var blobToBase64 = function blobToBase64(blob, callback) {\n      var reader = new FileReader();\n\n      reader.onload = function () {\n        var dataUrl = reader.result;\n        var base64 = dataUrl.split(\",\")[1];\n        callback(base64);\n      };\n\n      reader.readAsDataURL(blob);\n    };\n\n    return \"https://i.imgur.com/Gaor20G.jpeg\";\n  });\n\n  return function uploadImage(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var sendSms = function () {\n  var _ref2 = _asyncToGenerator(function* (phone) {\n    return fetch(api_link + \"/register/sendSms\", _objectSpread(_objectSpread({}, POST_PARAMS), {}, {\n      body: JSON.stringify({\n        phone: phone\n      })\n    })).then(function (res) {\n      return res.json();\n    }).then(function (res) {\n      return res;\n    });\n  });\n\n  return function sendSms(_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var verifyCode = function () {\n  var _ref3 = _asyncToGenerator(function* (id, code) {\n    return fetch(api_link + \"/register/verifyCode\", _objectSpread(_objectSpread({}, POST_PARAMS), {}, {\n      body: JSON.stringify({\n        id: id,\n        code: code\n      })\n    })).then(function (res) {\n      return res.json();\n    }).then(function (res) {\n      return res;\n    });\n  });\n\n  return function verifyCode(_x3, _x4) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var verifyUsername = function () {\n  var _ref4 = _asyncToGenerator(function* (username) {\n    return fetch(api_link + \"/user/verifyUsername\", _objectSpread(_objectSpread({}, POST_PARAMS), {}, {\n      body: JSON.stringify({\n        username: username\n      })\n    })).then(function (res) {\n      return res.json();\n    }).then(function (res) {\n      return res;\n    });\n  });\n\n  return function verifyUsername(_x5) {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var createProfile = function () {\n  var _ref5 = _asyncToGenerator(function* (user) {\n    if (user.profile.avatar) {\n      var uploadAvatar = yield uploadImage(user.profile.avatar);\n      user.profile.avatar = uploadAvatar;\n    }\n\n    ;\n    return fetch(api_link + \"/register/createUser\", _objectSpread(_objectSpread({}, POST_PARAMS), {}, {\n      body: JSON.stringify({\n        user: user\n      })\n    })).then(function (res) {\n      return res.json();\n    }).then(function (res) {\n      return res;\n    });\n  });\n\n  return function createProfile(_x6) {\n    return _ref5.apply(this, arguments);\n  };\n}();\nexport var searchUser = function () {\n  var _ref6 = _asyncToGenerator(function* (search) {\n    return fetch(api_link + \"/user/searchUser\", _objectSpread(_objectSpread({}, POST_PARAMS), {}, {\n      body: JSON.stringify({\n        search: search\n      })\n    })).then(function (res) {\n      return res.json();\n    }).then(function (res) {\n      return res;\n    });\n  });\n\n  return function searchUser(_x7) {\n    return _ref6.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["api_link","POST_PARAMS","method","headers","uploadImage","image","clientId","process","env","IMGUR_ID","clientSecret","IMGUR_SECRET","blobToBase64","blob","Promise","resolve","_","reader","FileReader","onloadend","result","readAsDataURL","callback","onload","dataUrl","base64","split","sendSms","phone","fetch","body","JSON","stringify","then","res","json","verifyCode","id","code","verifyUsername","username","createProfile","user","profile","avatar","uploadAvatar","searchUser","search"],"sources":["/home/samuel/Documentos/projetos/mobile/halk/client/middleware/api.ts"],"sourcesContent":["import ImgurClient from \"imgur\";\nconst api_link = \"http://localhost:3000\";\n\nconst POST_PARAMS = {\n  method: \"POST\",\n  headers: {\n    \"Content-type\": \"application/json\",\n  },\n};\n\nexport const uploadImage = async (image: any) => {\n  const clientId = process.env.IMGUR_ID;\n  const clientSecret = process.env.IMGUR_SECRET;\n\n  function blobToBase64(blob) {\n    return new Promise((resolve, _) => {\n      const reader = new FileReader();\n      reader.onloadend = () => resolve(reader.result);\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  var blobToBase64 = function (blob, callback) {\n    var reader = new FileReader();\n    reader.onload = function () {\n      var dataUrl = reader.result;\n      var base64 = dataUrl.split(\",\")[1];\n      callback(base64);\n    };\n    reader.readAsDataURL(blob);\n  };\n\n  return \"https://i.imgur.com/Gaor20G.jpeg\";\n};\n\nexport const sendSms = async (phone) => {\n  return fetch(`${api_link}/register/sendSms`, {\n    ...POST_PARAMS,\n    body: JSON.stringify({ phone: phone }),\n  })\n    .then((res) => res.json())\n    .then((res) => res);\n};\n\nexport const verifyCode = async (id, code) => {\n  return fetch(`${api_link}/register/verifyCode`, {\n    ...POST_PARAMS,\n    body: JSON.stringify({ id: id, code: code }),\n  })\n    .then((res) => res.json())\n    .then((res) => res);\n};\n\nexport const verifyUsername = async (username) => {\n  return fetch(`${api_link}/user/verifyUsername`, {\n    ...POST_PARAMS,\n    body: JSON.stringify({ username: username }),\n  })\n    .then((res) => res.json())\n    .then((res) => res);\n};\n\nexport const createProfile = async (user) => {\n  if(user.profile.avatar) {\n    const uploadAvatar = await uploadImage(user.profile.avatar);\n    user.profile.avatar = uploadAvatar;\n  };\n\n  return fetch(`${api_link}/register/createUser`, {\n    ...POST_PARAMS,\n    body: JSON.stringify({ user: user }),\n  })\n    .then((res) => res.json())\n    .then((res) => res);\n};\n\nexport const searchUser = async (search) => {\n  return fetch(`${api_link}/user/searchUser`, {\n    ...POST_PARAMS,\n    body: JSON.stringify({ search: search }),\n  })\n    .then((res) => res.json())\n    .then((res) => res);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}