{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { TextInput, Text } from \"../../src/components/Themed\";\nimport { UserContext } from \"../../src/contexts/user\";\nimport { ChatsContext } from \"../../src/contexts/chats\";\nimport { CreateSocketConnection } from \"../../src/utils/socket\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Chat(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      socket = _useState2[0],\n      setSocket = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      messages = _useState4[0],\n      setMessages = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      text = _useState6[0],\n      setText = _useState6[1];\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.user;\n\n  var _useContext2 = useContext(ChatsContext),\n      chats = _useContext2.chats;\n\n  useEffect(function () {\n    var chatId = route.params.id;\n\n    if (chatId) {\n      var socketConnection = CreateSocketConnection();\n      socketConnection.emit(\"joinRoom\", chatId);\n      setSocket(socketConnection);\n      socketConnection.on(\"receiveMessage\", function (msg, client) {\n        console.log(client);\n        setMessages(function (oldMessages) {\n          return [].concat(_toConsumableArray(oldMessages), [msg]);\n        });\n      });\n    }\n  }, [user, chats]);\n  useEffect(function () {\n    return console.log(messages);\n  }, [messages]);\n\n  function sendMessage() {\n    socket.emit(\"sendMessage\", text);\n    setText(\"\");\n  }\n\n  return _jsxs(View, {\n    children: [_jsx(View, {\n      children: messages.map(function (msg, index) {\n        return _jsx(Text, {\n          children: msg\n        }, index);\n      })\n    }), _jsxs(View, {\n      children: [_jsx(TextInput, {\n        placeholder: \"Mensagem...\",\n        value: text,\n        onChangeText: function onChangeText(value) {\n          return setText(value);\n        }\n      }), _jsx(TouchableOpacity, {\n        onPress: function onPress() {\n          return sendMessage();\n        },\n        children: _jsx(Text, {\n          children: \"Send\"\n        })\n      })]\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: StatusBar.currentHeight\n  },\n  topContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 5,\n    justifyContent: \"space-between\"\n  },\n  topContainerLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  topContainerRight: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\"\n  },\n  messageContainer: {\n    flex: 1,\n    marginHorizontal: 10,\n    flexDirection: \"column-reverse\",\n    marginBottom: 55\n  },\n  bottomContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    position: \"absolute\",\n    backgroundColor: \"rgb(18, 18, 18)\",\n    justifyContent: \"space-between\",\n    borderRadius: 50,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    padding: 5,\n    margin: 5\n  },\n  messageCard: {\n    borderWidth: 1,\n    borderColor: \"#222\"\n  },\n  myMessage: {\n    justifyContent: \"flex-end\",\n    flexDirection: \"revert\"\n  },\n  otherMessage: {\n    width: \"fit-content\",\n    maxWidth: \"85%\"\n  },\n  userIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 100,\n    marginHorizontal: 5\n  },\n  userProfile: {\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  backButton: {\n    padding: 5,\n    borderRadius: 100\n  },\n  blueButton: {\n    backgroundColor: \"#2f95dc\",\n    padding: 8,\n    borderRadius: 100\n  },\n  othersMedias: {\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  inputMessage: {\n    paddingVertical: 8,\n    width: \"100%\",\n    marginLeft: 10\n  },\n  message: {\n    padding: 7,\n    borderRadius: 20,\n    flexDirection: \"row\",\n    marginBottom: 10,\n    alignItems: \"flex-end\",\n    flexWrap: \"wrap\"\n  },\n  messageCreatedAt: {\n    fontSize: 10,\n    marginLeft: 5\n  },\n  buttonContentLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\"\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","useContext","TextInput","Text","UserContext","ChatsContext","CreateSocketConnection","Chat","navigation","route","socket","setSocket","messages","setMessages","text","setText","user","chats","chatId","params","id","socketConnection","emit","on","msg","client","console","log","oldMessages","sendMessage","map","index","value","styles","StyleSheet","create","container","flex","marginTop","StatusBar","currentHeight","topContainer","flexDirection","alignItems","padding","justifyContent","topContainerLeft","topContainerRight","messageContainer","marginHorizontal","marginBottom","bottomContainer","position","backgroundColor","borderRadius","bottom","left","right","margin","messageCard","borderWidth","borderColor","myMessage","otherMessage","width","maxWidth","userIcon","height","userProfile","backButton","blueButton","othersMedias","inputMessage","paddingVertical","marginLeft","message","flexWrap","messageCreatedAt","fontSize","buttonContentLeft"],"sources":["/home/samuel/Documentos/projetos/mobile/halk/client/screens/chat/chat.tsx"],"sourcesContent":["import React, { useEffect, useState, useContext, useRef } from \"react\";\nimport {\n  Button,\n  StatusBar,\n  StyleSheet,\n  View,\n  Image,\n  Pressable,\n  ScrollView,\n  TouchableOpacity,\n} from \"react-native\";\nimport {\n  AntDesign,\n  Ionicons,\n  Feather,\n  FontAwesome,\n  MaterialIcons,\n  Fontisto,\n} from \"@expo/vector-icons\";\nimport { RootStackScreenProps } from \"../../types\";\nimport { TextInput, Text } from \"../../src/components/Themed\";\nimport { UserContext } from \"../../src/contexts/user\";\nimport { ChatsContext } from \"../../src/contexts/chats\";\nimport Socket, { CreateSocketConnection } from \"../../src/utils/socket\";\nimport { getColors } from \"../../constants/Colors\";\n\nexport default function Chat({\n  navigation,\n  route,\n}: RootStackScreenProps<\"Chat\">) {\n  const [socket, setSocket] = useState();\n  const [messages, setMessages] = useState([]);\n  const [text, setText] = useState(\"\");\n\n  const { user } = useContext(UserContext);\n  const { chats } = useContext(ChatsContext);\n\n  useEffect(() => {\n    const chatId = route.params.id;\n\n    if (chatId) {\n      const socketConnection = CreateSocketConnection();\n      socketConnection.emit(\"joinRoom\", chatId);\n      setSocket(socketConnection);\n\n      socketConnection.on(\"receiveMessage\", (msg, client) => {\n        console.log(client);\n        setMessages(oldMessages => [...oldMessages, msg]);\n      });\n    }\n  }, [user, chats]);\n\n  useEffect(() => console.log(messages), [messages]);\n\n  function sendMessage() {\n    socket.emit(\"sendMessage\", text);\n    setText(\"\");\n  }\n\n  return (\n    <View>\n      <View>\n        {messages.map((msg, index) => (\n          <Text key={index}>{msg}</Text>\n        ))}\n      </View>\n      <View>\n        <TextInput\n          placeholder=\"Mensagem...\"\n          value={text}\n          onChangeText={(value) => setText(value)}\n        />\n        <TouchableOpacity onPress={() => sendMessage()}>\n          <Text>Send</Text>\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    marginTop: StatusBar.currentHeight,\n  },\n  topContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 5,\n    justifyContent: \"space-between\",\n  },\n  topContainerLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  topContainerRight: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n  },\n  messageContainer: {\n    flex: 1,\n    marginHorizontal: 10,\n    flexDirection: \"column-reverse\",\n    marginBottom: 55,\n  },\n  bottomContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    position: \"absolute\",\n    backgroundColor: \"rgb(18, 18, 18)\",\n    justifyContent: \"space-between\",\n    borderRadius: 50,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    padding: 5,\n    margin: 5,\n  },\n  messageCard: {\n    borderWidth: 1,\n    borderColor: \"#222\",\n  },\n  myMessage: {\n    justifyContent: \"flex-end\",\n    flexDirection: \"revert\",\n  },\n  otherMessage: {\n    width: \"fit-content\",\n    maxWidth: \"85%\",\n  },\n  userIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 100,\n    marginHorizontal: 5,\n  },\n  userProfile: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  backButton: {\n    padding: 5,\n    borderRadius: 100,\n  },\n  blueButton: {\n    backgroundColor: \"#2f95dc\",\n    padding: 8,\n    borderRadius: 100,\n  },\n  othersMedias: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  inputMessage: {\n    paddingVertical: 8,\n    width: \"100%\",\n    marginLeft: 10,\n  },\n  message: {\n    padding: 7,\n    borderRadius: 20,\n    flexDirection: \"row\",\n    marginBottom: 10,\n    alignItems: \"flex-end\",\n    flexWrap: \"wrap\",\n  },\n  messageCreatedAt: {\n    fontSize: 10,\n    marginLeft: 5,\n  },\n  buttonContentLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}