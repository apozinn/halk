{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState, useContext, useRef } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { UserContext } from \"../../src/contexts/user\";\nimport { ChatsContext } from \"../../src/contexts/chats\";\nimport { SocketContext } from \"../../src/contexts/socket\";\nimport { SocketController } from \"../../src/utils/socket\";\nimport { getColors } from \"../../constants/Colors\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar badgeProps = {\n  size: 25,\n  borderRadius: 50,\n  animate: true\n};\nexport default function Chat(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.user;\n\n  var _useContext2 = useContext(ChatsContext),\n      chats = _useContext2.chats,\n      updateChats = _useContext2.updateChats;\n\n  var socket = useContext(SocketContext);\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      text = _useState4[0],\n      setText = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      chat = _useState6[0],\n      setChat = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      online = _useState8[0],\n      setOnline = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      userTyping = _useState10[0],\n      setUserTyping = _useState10[1];\n\n  var colors = getColors();\n  var scrollViewRef = useRef();\n  useEffect(function () {\n    if (!user || !chats || !socket) return;\n    var chatId = route.params.id;\n\n    if (chatId) {\n      var thisChat = chats.filter(function (c) {\n        return c.id === chatId;\n      })[0];\n\n      if (thisChat) {\n        setChat(thisChat);\n      } else setChat(new SocketController.sendHalkMessage());\n    } else navigation.goBack();\n\n    socket.on(\"receiveMessage\", function (msg) {\n      console.log(msg);\n    });\n  }, []);\n  useEffect(function () {\n    if (chat && socket) {\n      new SocketController.joinedChat({\n        chats: chats,\n        chat: chat,\n        socket: socket\n      });\n      socket.on(\"receiveIfUserIsOnline\", function (callback) {\n        return setOnline(callback);\n      });\n    }\n  }, [chat]);\n\n  function sendMessage() {\n    new SocketController.sendMessage({\n      chats: chats,\n      chat: chat,\n      socket: socket\n    });\n  }\n\n  return _jsx(View, {});\n}","map":{"version":3,"names":["React","useEffect","useState","useContext","useRef","UserContext","ChatsContext","SocketContext","SocketController","getColors","badgeProps","size","borderRadius","animate","Chat","navigation","route","user","chats","updateChats","socket","messages","setMessages","text","setText","chat","setChat","online","setOnline","userTyping","setUserTyping","colors","scrollViewRef","chatId","params","id","thisChat","filter","c","sendHalkMessage","goBack","on","msg","console","log","joinedChat","callback","sendMessage"],"sources":["/home/samuel/Documentos/projetos/mobile/halk/client/screens/chat/chat.tsx"],"sourcesContent":["import React, { useEffect, useState, useContext, useRef } from \"react\";\nimport {\n  Button,\n  StatusBar,\n  StyleSheet,\n  View,\n  Image,\n  Pressable,\n  ScrollView,\n  TouchableOpacity,\n} from \"react-native\";\nimport {\n  AntDesign,\n  Ionicons,\n  Feather,\n  FontAwesome,\n  MaterialIcons,\n  Fontisto,\n} from \"@expo/vector-icons\";\nimport { RootStackScreenProps } from \"../../types\";\nimport { TextInput, Text } from \"../../src/components/Themed\";\nimport { UserContext } from \"../../src/contexts/user\";\nimport { ChatsContext } from \"../../src/contexts/chats\";\nimport { SocketContext } from \"../../src/contexts/socket\";\nimport { SocketController } from \"../../src/utils/socket\";\nimport { getColors } from \"../../constants/Colors\";\nimport { Cipher, Decipher } from \"../../middleware/crypto\";\nimport { Userpic } from \"react-native-userpic\";\n\nconst badgeProps = {\n  size: 25,\n  borderRadius: 50,\n  animate: true,\n};\n\nexport default function Chat({ navigation, route }) {\n  const { user } = useContext(UserContext);\n  const { chats, updateChats } = useContext(ChatsContext);\n  const socket = useContext(SocketContext);\n\n  const [messages, setMessages] = useState([]);\n  const [text, setText] = useState(\"\");\n  const [chat, setChat] = useState();\n  const [online, setOnline] = useState(false);\n  const [userTyping, setUserTyping] = useState(false);\n\n  const colors = getColors();\n  const scrollViewRef = useRef();\n\n  useEffect(() => {\n    if(!user || !chats || !socket) return;\n\n    const chatId = route.params.id;\n    if(chatId) {\n      var thisChat = chats.filter((c) => c.id === chatId)[0];\n      if(thisChat) {\n        setChat(thisChat);\n      } else setChat(new SocketController.sendHalkMessage());\n    } else navigation.goBack();\n\n    socket.on(\"receiveMessage\", (msg) => {\n      console.log(msg);\n    });\n  }, []);\n\n  useEffect(() => {\n    if(chat && socket) {\n      new SocketController.joinedChat({ chats, chat, socket });\n      socket.on(\"receiveIfUserIsOnline\", (callback) => setOnline(callback));\n    }\n  }, [chat]);\n\n  function sendMessage() {\n    new SocketController.sendMessage({ chats, chat, socket });\n  }\n\n  return (<View></View>)\n}"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,EAAqCC,UAArC,EAAiDC,MAAjD,QAA+D,OAA/D;;AAqBA,SAASC,WAAT;AACA,SAASC,YAAT;AACA,SAASC,aAAT;AACA,SAASC,gBAAT;AACA,SAASC,SAAT;;AAIA,IAAMC,UAAU,GAAG;EACjBC,IAAI,EAAE,EADW;EAEjBC,YAAY,EAAE,EAFG;EAGjBC,OAAO,EAAE;AAHQ,CAAnB;AAMA,eAAe,SAASC,IAAT,OAAqC;EAAA,IAArBC,UAAqB,QAArBA,UAAqB;EAAA,IAATC,KAAS,QAATA,KAAS;;EAClD,kBAAiBb,UAAU,CAACE,WAAD,CAA3B;EAAA,IAAQY,IAAR,eAAQA,IAAR;;EACA,mBAA+Bd,UAAU,CAACG,YAAD,CAAzC;EAAA,IAAQY,KAAR,gBAAQA,KAAR;EAAA,IAAeC,WAAf,gBAAeA,WAAf;;EACA,IAAMC,MAAM,GAAGjB,UAAU,CAACI,aAAD,CAAzB;;EAEA,gBAAgCL,QAAQ,CAAC,EAAD,CAAxC;EAAA;EAAA,IAAOmB,QAAP;EAAA,IAAiBC,WAAjB;;EACA,iBAAwBpB,QAAQ,CAAC,EAAD,CAAhC;EAAA;EAAA,IAAOqB,IAAP;EAAA,IAAaC,OAAb;;EACA,iBAAwBtB,QAAQ,EAAhC;EAAA;EAAA,IAAOuB,IAAP;EAAA,IAAaC,OAAb;;EACA,iBAA4BxB,QAAQ,CAAC,KAAD,CAApC;EAAA;EAAA,IAAOyB,MAAP;EAAA,IAAeC,SAAf;;EACA,iBAAoC1B,QAAQ,CAAC,KAAD,CAA5C;EAAA;EAAA,IAAO2B,UAAP;EAAA,IAAmBC,aAAnB;;EAEA,IAAMC,MAAM,GAAGtB,SAAS,EAAxB;EACA,IAAMuB,aAAa,GAAG5B,MAAM,EAA5B;EAEAH,SAAS,CAAC,YAAM;IACd,IAAG,CAACgB,IAAD,IAAS,CAACC,KAAV,IAAmB,CAACE,MAAvB,EAA+B;IAE/B,IAAMa,MAAM,GAAGjB,KAAK,CAACkB,MAAN,CAAaC,EAA5B;;IACA,IAAGF,MAAH,EAAW;MACT,IAAIG,QAAQ,GAAGlB,KAAK,CAACmB,MAAN,CAAa,UAACC,CAAD;QAAA,OAAOA,CAAC,CAACH,EAAF,KAASF,MAAhB;MAAA,CAAb,EAAqC,CAArC,CAAf;;MACA,IAAGG,QAAH,EAAa;QACXV,OAAO,CAACU,QAAD,CAAP;MACD,CAFD,MAEOV,OAAO,CAAC,IAAIlB,gBAAgB,CAAC+B,eAArB,EAAD,CAAP;IACR,CALD,MAKOxB,UAAU,CAACyB,MAAX;;IAEPpB,MAAM,CAACqB,EAAP,CAAU,gBAAV,EAA4B,UAACC,GAAD,EAAS;MACnCC,OAAO,CAACC,GAAR,CAAYF,GAAZ;IACD,CAFD;EAGD,CAdQ,EAcN,EAdM,CAAT;EAgBAzC,SAAS,CAAC,YAAM;IACd,IAAGwB,IAAI,IAAIL,MAAX,EAAmB;MACjB,IAAIZ,gBAAgB,CAACqC,UAArB,CAAgC;QAAE3B,KAAK,EAALA,KAAF;QAASO,IAAI,EAAJA,IAAT;QAAeL,MAAM,EAANA;MAAf,CAAhC;MACAA,MAAM,CAACqB,EAAP,CAAU,uBAAV,EAAmC,UAACK,QAAD;QAAA,OAAclB,SAAS,CAACkB,QAAD,CAAvB;MAAA,CAAnC;IACD;EACF,CALQ,EAKN,CAACrB,IAAD,CALM,CAAT;;EAOA,SAASsB,WAAT,GAAuB;IACrB,IAAIvC,gBAAgB,CAACuC,WAArB,CAAiC;MAAE7B,KAAK,EAALA,KAAF;MAASO,IAAI,EAAJA,IAAT;MAAeL,MAAM,EAANA;IAAf,CAAjC;EACD;;EAED,OAAQ,KAAC,IAAD,KAAR;AACD"},"metadata":{},"sourceType":"module"}